# Arabidopsis thaliana GWAS Analysis – Detailed Scenario (Strict Filtering)

**Date:** 2025-07-02  
**Tool Used:** `PlantVarFilter`  
**Objective:** Run a strict GWAS scenario using Arabidopsis thaliana data with multiple consequence types and trait covariates.

---

##  Input Files

| Type           | Description                          | File Path |
|----------------|--------------------------------------|-----------|
| VCF File       | Variants with consequences           | `/home/ahmed/Desktop/arabidopsis_project/input/arabidopsis_thaliana_incl_consequences.vcf.gz` |
| GFF3 File      | Arabidopsis gene annotations         | `/home/ahmed/Desktop/arabidopsis_project/input/Arabidopsis_thaliana.TAIR10.61.gff3.gz` |
| Traits File    | Traits with covariates (e.g., Age, Environment) | `/home/ahmed/Desktop/arabidopsis_project/input/Arabidopsis_Trait_Data_with_Covariates.csv` |

## Data Source 
- https://ftp.ensemblgenomes.ebi.ac.uk/pub/plants/current/variation/vcf/arabidopsis_thaliana/
- https://ftp.ensemblgenomes.ebi.ac.uk/pub/plants/current/gff3/arabidopsis_thaliana/
---

##  Configuration

```json
{
  "vcf": "/home/ahmed/Desktop/arabidopsis_project/input/arabidopsis_thaliana_incl_consequences.vcf.gz",
  "gff": "/home/ahmed/Desktop/arabidopsis_project/input/Arabidopsis_thaliana.TAIR10.61.gff3.gz",
  "traits": "/home/ahmed/Desktop/arabidopsis_project/input/Arabidopsis_Trait_Data_with_Covariates.csv",
  "include_intergenic": false,
  "consequence_types": [
    "missense_variant",
    "stop_gained",
    "synonymous_variant",
    "frameshift_variant",
    "start_lost",
    "stop_lost",
    "splice_donor_variant",
    "splice_acceptor_variant",
    "inframe_insertion",
    "inframe_deletion",
    "protein_altering_variant"
  ],
  "output_format": "csv",
  "output": "/home/ahmed/Desktop/arabidopsis_project/output/filtered_arabidopsis.csv",
  "plot": true,
  "gwas": true,
  "gwas_results": "/home/ahmed/Desktop/arabidopsis_project/output/gwas_strict_results.csv",
  "gwas_with_covariates": true,
  "gwas_covariate_results": "/home/ahmed/Desktop/arabidopsis_project/output/gwas_regression_results.csv",
  "output_dir": "/home/ahmed/Desktop/arabidopsis_project/output"
}
```

---

##  Execution Summary

| Step                          | Status/Details |
|-------------------------------|----------------|
| Read VCF                      | ✅ Completed |
| Filtered intergenic variants  | ✅ 7,373,361 skipped |
| Gene DB Built                 | ✅ 27,655 genes |
| Annotated with genes          | ✅ Done |
| Annotated with traits         | ✅ 3,457 variants annotated |
| Generated Plots               | ✅ Attempted |
| GWAS Basic Analysis           | ✅ Done, results saved |
| Manhattan Plot                | ⚠️ No valid P-values (data-related) |
| GWAS Regression (with covariates) | ✅ Done, results saved |
| Total Runtime                 | ⏱️ 60.43 seconds |

---

## Output Files

| File | Description |
|------|-------------|
| `filtered_arabidopsis.csv` | Filtered variants with annotations |
| `gwas_strict_results.csv` | GWAS analysis using T-test |
| `gwas_regression_results.csv` | GWAS with covariates (multi-variable) |

---

##  Purpose of This Scenario

- **Strict Filtering:** Test the pipeline's behavior under stringent filtering using a wide range of consequence types.
- **Covariates Analysis:** Test multi-trait GWAS analysis with real covariate columns like Age and Environment for regression modeling.

---

## Notes

- Manhattan Plot warning is expected due to data lacking valid P-values.
- Ensure future trait files contain enough variation for plot generation.

---

Generated by `PlantVarFilter` — Arabidopsis GWAS test on 2025-07-02